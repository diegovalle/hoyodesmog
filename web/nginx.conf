server {
        listen   80; ## listen for ipv4; this line is default and implied
        #listen   [::]:80 default ipv6only=on; ## listen for ipv6

        root /var/www/hoyodesmog.diegovalle.net/web;
        index index.html index.htm;

        # Make site accessible from http://localhost/
        server_name hoyodesmog.diegovalle.net;

error_page 404 /404.html;
        location  /404.html {
              internal;
              root /var/www/crimenmexico.diegovalle.net;
        }
        location / {
             try_files $uri $uri/index.html $uri.html =404;
        }


        gzip_static on;

        error_page 500 502 503 504 /50x.html;
        location = /50x.html {
              root /usr/share/nginx/www;
        }

        # Media: images, icons, video, audio, HTC
        location ~* \.(?:jpg|jpeg|gif|png|ico|cur|gz|svg|svgz|mp4|ogg|ogv|webm|htc|geojson|woff)$ {
          expires 1M;
          access_log off;
          add_header Cache-Control "public";
        }

        # Feed
        location ~* \.(?:rss|atom)$ {
          expires 1h;
          add_header Cache-Control "public";
        }

        location = / {
          expires -1;
          add_header Link "</images/mx.png>; rel=\"preload\"; as=\"image\"";
          add_header Link "</assets/js/d3.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/mapbox.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/jquery.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/jquery.dropotron.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/skel.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/util.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/main.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</js/d3-color.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</js/L.CanvasOverlay.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</js/leaflet.locate/L.Control.Locate.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</js/leaflet.hash/leaflet-hash.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/rbush.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/moment/moment.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/moment/locales.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</js/heatmap-imeca.js?v=1.1>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/css/font-awesome.min.css>; rel=\"preload\"; as=\"style\"";
          add_header Link "</assets/css/leaflet.css>; rel=\"preload\"; as=\"style\"";
          add_header Link "</assets/css/smog.css>; rel=\"preload\"; as=\"style\"";
          add_header Link "</assets/css/leaflet.locate/L.Control.Locate.min.css>; rel=\"preload\"; as=\"style\"";
          add_header Link "</assets/css/main.css?v=1>; rel=\"preload\"; as=\"style\"";
          add_header Link "</assets/fonts/fontawesome-webfont.woff2?v=4.3.0>; rel=\"preload\"; as=\"font\"";
          add_header Link "</assets/css/css/font.css>; rel=\"preload\"; as=\"stylet\"";
          add_header Link "</assets/css/fonts/montserrat-72522d594a67810a26c1858894cb418e9fe38702.woff>; rel=\"preload\"; as=\"font\"";      
          add_header Link "</assets/css/fonts/sourcesanspro-29c9632b40abe339a91d1d90eea2880453408a62.woff>; rel=\"preload\"; as=\"font\"";
          add_header Link "</assets/css/fonts/montserrat-61cb89b110ed43d78c22ee23415ca0975be3cc9e.woff; rel=\"preload\"; as=\"font\"";
        }    

        location = /es/ {
          expires -1;
          add_header Link "</assets/js/d3.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/mapbox.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/jquery.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/jquery.dropotron.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/skel.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/util.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/main.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</js/d3-color.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</js/L.CanvasOverlay.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</js/leaflet.locate/L.Control.Locate.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</js/leaflet.hash/leaflet-hash.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/rbush.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/moment/moment.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/moment/locales.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</images/us.png>; rel=\"preload\"; as=\"image\"";
          add_header Link "</js/heatmap-imeca.js?v=1.1>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/css/font-awesome.min.css>; rel=\"preload\"; as=\"style\"";
          add_header Link "</assets/css/leaflet.css>; rel=\"preload\"; as=\"style\"";
          add_header Link "</assets/css/smog.css>; rel=\"preload\"; as=\"style\"";
          add_header Link "</assets/css/leaflet.locate/L.Control.Locate.min.css>; rel=\"preload\"; as=\"style\"";
          add_header Link "</assets/css/main.css?v=1>; rel=\"preload\"; as=\"style\"";
          add_header Link "</assets/fonts/fontawesome-webfont.woff2?v=4.3.0>; rel=\"preload\"; as=\"font\"";
          add_header Link "</assets/css/css/font.css>; rel=\"preload\"; as=\"stylet\"";
          add_header Link "</assets/css/fonts/montserrat-72522d594a67810a26c1858894cb418e9fe38702.woff>; rel=\"preload\"; as=\"font\"";      
          add_header Link "</assets/css/fonts/sourcesanspro-29c9632b40abe339a91d1d90eea2880453408a62.woff>; rel=\"preload\"; as=\"font\"";
          add_header Link "</assets/css/fonts/montserrat-61cb89b110ed43d78c22ee23415ca0975be3cc9e.woff; rel=\"preload\"; as=\"font\"";
        
        }  
   
        location ~* \.html {
          expires -1;
          add_header Link "</images/mx.png>; rel=\"preload\"; as=\"image\"";
          add_header Link "</assets/js/jquery.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/jquery.dropotron.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/skel.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/util.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/main.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</js/d3-color.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</js/L.CanvasOverlay.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</js/leaflet.locate/L.Control.Locate.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</js/leaflet.hash/leaflet-hash.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/rbush.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/moment/moment.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/moment/locales.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</images/us.png>; rel=\"preload\"; as=\"image\"";
          add_header Link "</assets/css/css/font.css>; rel=\"preload\"; as=\"style\"";
          add_header Link "</assets/css/fonts/montserrat-72522d594a67810a26c1858894cb418e9fe38702.woff>; rel=\"preload\"; as=\"font\"";      
          add_header Link "</assets/css/fonts/sourcesanspro-29c9632b40abe339a91d1d90eea2880453408a62.woff>; rel=\"preload\"; as=\"font\"";
          add_header Link "</assets/css/fonts/montserrat-61cb89b110ed43d78c22ee23415ca0975be3cc9e.woff; rel=\"preload\"; as=\"font\"";
        }
        location ~* index.html$ {
          expires -1;
          add_header Link "</images/mx.png>; rel=\"preload\"; as=\"image\"";
          add_header Link "</assets/js/d3.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/mapbox.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/jquery.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/jquery.dropotron.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/skel.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/util.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/main.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</js/d3-color.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</js/L.CanvasOverlay.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</js/leaflet.locate/L.Control.Locate.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</js/leaflet.hash/leaflet-hash.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/rbush.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/moment/moment.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/moment/locales.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</js/heatmap-imeca.js?v=1.1>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/css/font-awesome.min.css>; rel=\"preload\"; as=\"style\"";
          add_header Link "</assets/css/leaflet.css>; rel=\"preload\"; as=\"style\"";
          add_header Link "</assets/css/smog.css>; rel=\"preload\"; as=\"style\"";
          add_header Link "</assets/css/leaflet.locate/L.Control.Locate.min.css>; rel=\"preload\"; as=\"style\"";
          add_header Link "</assets/css/main.css?v=1>; rel=\"preload\"; as=\"style\"";
          add_header Link "</assets/fonts/fontawesome-webfont.woff2?v=4.3.0>; rel=\"preload\"; as=\"font\"";
          add_header Link "</assets/css/css/font.css>; rel=\"preload\"; as=\"stylet\"";
          add_header Link "</assets/css/fonts/montserrat-72522d594a67810a26c1858894cb418e9fe38702.woff>; rel=\"preload\"; as=\"font\"";      
          add_header Link "</assets/css/fonts/sourcesanspro-29c9632b40abe339a91d1d90eea2880453408a62.woff>; rel=\"preload\"; as=\"font\"";
          add_header Link "</assets/css/fonts/montserrat-61cb89b110ed43d78c22ee23415ca0975be3cc9e.woff; rel=\"preload\"; as=\"font\"";
        }
        location ~* wind.html$ {
          expires -1;
          add_header Link "</images/mx.png>; rel=\"preload\"; as=\"image\"";
          add_header Link "</assets/js/d3.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/mapbox.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/jquery.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/jquery.dropotron.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/skel.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/util.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/main.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</js/d3-color.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</js/L.CanvasOverlay.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</js/leaflet.locate/L.Control.Locate.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</js/leaflet.hash/leaflet-hash.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/rbush.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/moment/moment.min.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/js/moment/locales.js>; rel=\"preload\"; as=\"script\"";
          add_header Link "</assets/css/font-awesome.min.css>; rel=\"preload\"; as=\"style\"";
          add_header Link "</assets/css/leaflet.css>; rel=\"preload\"; as=\"style\"";
          add_header Link "</assets/css/smog.css>; rel=\"preload\"; as=\"style\"";
          add_header Link "</assets/css/leaflet.locate/L.Control.Locate.min.css>; rel=\"preload\"; as=\"style\"";
          add_header Link "</assets/css/main.css?v=1>; rel=\"preload\"; as=\"style\"";
          add_header Link "</assets/fonts/fontawesome-webfont.woff2?v=4.3.0>; rel=\"preload\"; as=\"font\"";
          add_header Link "</assets/css/css/font.css>; rel=\"preload\"; as=\"stylet\"";
          add_header Link "</assets/css/fonts/montserrat-72522d594a67810a26c1858894cb418e9fe38702.woff>; rel=\"preload\"; as=\"font\"";      
          add_header Link "</assets/css/fonts/sourcesanspro-29c9632b40abe339a91d1d90eea2880453408a62.woff>; rel=\"preload\"; as=\"font\"";
          add_header Link "</assets/css/fonts/montserrat-61cb89b110ed43d78c22ee23415ca0975be3cc9e.woff; rel=\"preload\"; as=\"font\"";
          add_header Link "</js/wind.js?v=1.1>; rel=\"preload\"; as=\"script\"";
        }
        #location ~* [a-zA-Z]*\.html {
        #  expires -1;
        #  add_header Link "</images/mx.png>; rel=\"preload\"; as=\"image\"";
        #}
        #location ~* /es/.*\.html {
        #  expires -1;
        #  add_header Link "</images/us.png>; rel=\"preload\"; as=\"image\"";
        #}
        # cache.appcache, your document html and data
        location ~* \.(?:manifest|appcache|html?|xml|json|csv)$ {
          expires -1;
          # access_log logs/static.log; # I don't usually include a static log
        }

	# CSS and Javascript
        location ~* \.(?:css|js)$ {
          expires 1y;
          access_log off;
          add_header Cache-Control "public";
        }

}

